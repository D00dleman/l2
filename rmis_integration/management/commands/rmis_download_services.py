from django.core.management import BaseCommand

from rmis_integration.client import Client as RC


class Command(BaseCommand):
    help = "Копирование услуг в другую организацию"

    def add_arguments(self, parser):
        parser.add_argument('rmis_login', type=str, help="RMIS login to upload")
        parser.add_argument('rmis_password', type=str, help="RMIS password to upload")
        parser.add_argument('rmis_orgid', type=str, help="RMIS organization id to upload")
        parser.add_argument('type_id', type=str, help="Can be None")

    def handle(self, *args, **options):
        c = RC()
        codes = "A08.01.001 A08.01.002 A08.01.003 A08.02.001 A08.03.001 A08.03.002 A08.03.003 A08.03.004 A08.04.001 A08.04.002 A08.04.003 A08.05.001 A08.05.002 A08.05.003 A08.05.004 A08.05.005 A08.05.006 A08.05.007 A08.05.008 A08.05.009 A08.05.014 A08.06.001 A08.06.002 A08.06.003 A08.06.004 A08.06.005 A08.07.001 A08.07.002 A08.07.003 A08.07.004 A08.07.005 A08.07.006 A08.07.007 A08.07.008 A08.07.009 A08.08.001 A08.08.002 A08.08.003 A08.08.004 A08.09.001 A08.09.002 A08.09.003 A08.09.005 A08.09.006 A08.10.001 A08.11.001 A08.11.002 A08.11.003 A08.12.001 A08.14.001 A08.14.002 A08.14.003 A08.14.004 A08.15.001 A08.15.002 A08.16.001 A08.16.002 A08.16.003 A08.16.004 A08.16.005 A08.16.006 A08.16.007 A08.16.008 A08.17.001 A08.17.002 A08.18.001 A08.18.002 A08.18.003 A08.19.001 A08.19.002 A08.19.003 A08.19.004 A08.19.005 A08.19.006 A08.20.001 A08.20.002 A08.20.003 A08.20.004 A08.20.005 A08.20.006 A08.20.007 A08.20.008 A08.20.009 A08.20.011 A08.20.012 A08.20.013 A08.20.014 A08.20.015 A08.21.003 A08.21.004 A08.21.005 A08.21.006 A08.21.007 A08.22.002 A08.22.003 A08.22.004 A08.22.005 A08.22.006 A08.22.007 A08.22.008 A08.23.001 A08.23.002 A08.23.003 A08.24.001 A08.25.001 A08.26.001 A08.26.002 A08.26.005 A08.26.006 A08.26.007 A08.28.001 A08.28.003 A08.28.004 A08.28.005 A08.28.006 A08.28.008 A08.28.009 A08.28.012 A08.28.013 A08.28.014 A08.30.001 A08.30.002 A08.30.003 A08.30.006 A08.30.007 A08.30.010 A08.30.011 A08.30.012 A08.30.014 A08.30.015 A08.30.016 A08.30.018 A08.30.020 A08.30.024 A08.30.025 A08.30.030 A09.01.001 A09.01.002 A09.01.004 A09.01.006 A09.04.002 A09.04.003 A09.04.004 A09.04.005 A09.05.002 A09.05.004 A09.05.006 A09.05.007 A09.05.008 A09.05.009 A09.05.010 A09.05.011 A09.05.014 A09.05.017 A09.05.018 A09.05.020 A09.05.021 A09.05.022 A09.05.023 A09.05.023.001 A09.05.023.002 A09.05.025 A09.05.026 A09.05.027 A09.05.028 A09.05.029 A09.05.030 A09.05.031 A09.05.032 A09.05.033 A09.05.034 A09.05.035 A09.05.037 A09.05.038 A09.05.039 A09.05.041 A09.05.042 A09.05.043 A09.05.044 A09.05.045 A09.05.046 A09.05.047 A09.05.048 A09.05.050 A09.05.051 A09.05.054 A09.05.054.001 A09.05.056 A09.05.058 A09.05.061 A09.05.062 A09.05.063 A09.05.064 A09.05.065 A09.05.066 A09.05.067 A09.05.069 A09.05.073 A09.05.074 A09.05.076 A09.05.077 A09.05.078 A09.05.079 A09.05.080 A09.05.083 A09.05.087 A09.05.095 A09.05.106.001 A09.05.106.002 A09.05.106.003 A09.05.106.004 A09.05.106.005 A09.05.106.007 A09.05.108 A09.05.109 A09.05.115 A09.05.117 A09.05.118 A09.05.119 A09.05.121 A09.05.125 A09.05.127 A09.05.130 A09.05.131 A09.05.132 A09.05.135 A09.05.139 A09.05.148 A09.05.149 A09.05.151 A09.05.154 A09.05.159 A09.05.160 A09.05.173 A09.05.174 A09.05.176 A09.05.177 A09.05.179 A09.05.181 A09.05.184 A09.05.185 A09.05.186 A09.05.187 A09.05.188 A09.05.189 A09.05.190 A09.05.193 A09.05.193.001 A09.05.195 A09.05.200 A09.05.201 A09.05.202 A09.05.204 A09.05.205 A09.05.206 A09.05.207 A09.05.209 A09.05.214 A09.05.220 A09.05.221 A09.05.225 A09.07.001 A09.07.002 A09.07.003 A09.08.002 A09.09.001 A09.09.002 A09.09.005 A09.09.007 A09.09.008 A09.09.010 A09.09.011 A09.14.001 A09.16.014 A09.16.014.001 A09.19.001 A09.19.002 A09.19.003 A09.19.004 A09.19.007 A09.19.009 A09.19.010 A09.20.001 A09.20.003 A09.20.004 A09.20.005 A09.20.007 A09.20.010 A09.21.003 A09.21.005 A09.23.001 A09.23.008 A09.28.001 A09.28.002 A09.28.003 A09.28.003.001 A09.28.005 A09.28.006 A09.28.007 A09.28.008 A09.28.009 A09.28.010 A09.28.012 A09.28.013 A09.28.014 A09.28.015.001 A09.28.017 A09.28.022 A09.28.026 A09.28.027 A09.28.028 A09.28.032 A09.28.033 A09.28.034 A09.28.035 A09.28.039 A09.28.050 A09.30.004 A09.30.006 A09.30.010 A11.05.001 A12.05.001 A12.05.002 A12.05.004 A12.05.005 A12.05.006 A12.05.007 A12.05.008 A12.05.009 A12.05.011 A12.05.014 A12.05.015 A12.05.017 A12.05.019 A12.05.027 A12.05.028 A12.05.035 A12.05.039 A12.05.040 A12.05.041 A12.05.042 A12.05.044 A12.05.045 A12.05.049 A12.06.001 A12.06.001.011 A12.06.003 A12.06.006 A12.06.010 A12.06.015 A12.06.016 A12.06.017 A12.06.018 A12.06.019 A12.06.020 A12.06.029 A12.06.030 A12.06.036 A12.06.037 A12.06.039 A12.06.043 A12.06.044 A12.06.045 A12.06.046 A12.09.001 A12.09.001.001 A12.09.002 A12.09.002.001 A12.09.002.002 A12.09.004 A12.09.005 A26.01.001 A26.01.005 A26.01.008 A26.01.009 A26.01.010 A26.01.013 A26.01.014 A26.01.015 A26.01.017 A26.01.018 A26.01.019 A26.02.001 A26.02.002 A26.02.004 A26.04.007 A26.05.001 A26.05.005 A26.05.009 A26.05.011 A26.05.012 A26.05.013 A26.05.016 A26.05.017 A26.05.018 A26.05.019 A26.05.020 A26.06.004 A26.06.006 A26.06.014 A26.06.015 A26.06.018 A26.06.022 A26.06.024 A26.06.025 A26.06.028 A26.06.029 A26.06.030 A26.06.032 A26.06.033 A26.06.034 A26.06.035 A26.06.036 A26.06.037 A26.06.038 A26.06.039 A26.06.040 A26.06.041 A26.06.043 A26.06.045 A26.06.046 A26.06.048 A26.06.056 A26.06.057 A26.06.058 A26.06.062 A26.06.063 A26.06.071 A26.06.072 A26.06.079 A26.06.080 A26.06.081 A26.06.082 A26.06.082.001 A26.06.082.003 A26.06.082.005 A26.07.002 A26.07.004 A26.07.006 A26.08.001 A26.08.003 A26.08.005 A26.08.006 A26.08.008 A26.08.009 A26.09.001 A26.09.010 A26.09.015 A26.09.022 A26.09.024 A26.14.002 A26.14.003 A26.14.006 A26.19.001 A26.19.003 A26.19.007 A26.19.008 A26.19.009 A26.19.011 A26.20.005 A26.20.006 A26.20.009 A26.20.012 A26.20.013 A26.20.014 A26.20.016 A26.20.020 A26.20.011 A26.21.004 A26.21.005 A26.21.006 A26.21.007 A26.21.008 A26.21.009 A26.21.010 A26.21.014 A26.23.006 A26.23.010 A26.23.013 A26.25.001 A26.25.004 A26.26.001 A26.26.008 A26.28.002 A26.28.003 A26.28.004 A26.28.007 A26.28.008 A26.30.002 A26.30.004 A26.30.005 A26.30.006 A26.30.007 B03.016.002 B03.016.003 B03.016.004 B03.016.005 B03.016.006 B03.016.010".split(  # noqa: E501
            " "
        )
        cnt_codes = len(codes)
        self.stdout.write("Codes: " + str(cnt_codes))
        directory = []
        i = 0
        for code in codes:
            i += 1
            id = c.dirservices.get_service_id_by_code(code)
            if id == -1:
                continue
            directory.append(c.dirservices.get_service_data(id, options['type_id']))
            self.stdout.write("~~~ %s/%s" % (i, cnt_codes))
        self.stdout.write("Cached: " + str(len(directory)))
        c_upload = RC(login=options["rmis_login"], password=options["rmis_password"])
        self.stdout.write("Filter...")
        cnt_codes = len(directory)
        filtered_directory = []
        i = 0
        for row in directory:
            i += 1
            self.stdout.write("Check %s/%s" % (i, cnt_codes))
            id = c_upload.dirservices.get_service_id_by_code(row["code"], orgid=options["rmis_orgid"])
            if id == -1:
                filtered_directory.append(row)
        self.stdout.write("To upload %s/%s" % (len(filtered_directory), cnt_codes))
        i = 0
        for row in filtered_directory:
            i += 1
            self.stdout.write(str(c_upload.dirservices.createService(data=row, orgid=options["rmis_orgid"])))
            self.stdout.write("Uploaded %s/%s" % (i, cnt_codes))
